<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>分块运动</title>
<style>
*{margin:0;padding:0;list-style:none;}
body{background:url(images/bg_main.jpg);height:600px;overflow:hidden;}

input{width:100px;height:50px;font-size:22px;line-height:50px;}
#div1{position:relative;width:900px;height:500px;background:url(images/img1/1.png);margin:30px auto;box-shadow:15px 15px 25px rgba(153,51,0,.7);}
#div1 div{background:url(images/img1/0.png);}
</style>
<script src="JS/move8.js"></script>
<script>
window.onload=function(){
	document.title = "分块运动--童剑瑛";
	var oDiv=document.getElementById('div1');
	var oBtn1=document.getElementById('btn1');
	var oBtn2=document.getElementById('btn2');
	var oBtn3=document.getElementById('btn3');

    var ready=true;

	var nCol=9;
	var nRow=5;
	for(var r=0;r<nRow;r++){
		for(var c=0;c<nCol;c++){
			var oBox=document.createElement('div');
			oBox.style.width=oDiv.offsetWidth/nCol+'px';
			oBox.style.height=oDiv.offsetHeight/nRow+'px';
			oBox.style.left=c*oDiv.offsetWidth/nCol+'px';
			oBox.style.top=r*oDiv.offsetHeight/nRow+'px';
			oBox.style.position='absolute';
			oBox.style.backgroundPosition=(-c*oDiv.offsetWidth/nCol)+'px '+(-r*oDiv.offsetHeight/nRow)+'px';
			oBox.r=r;
			oBox.c=c;
			
			oDiv.appendChild(oBox);
		}
	}
	
	var now=0;
	var aBox=oDiv.children;	

	oBtn1.onclick=function(){
		
		if(!ready) return;
		
		ready=false;
		
		var i=0;
		
		now++;
		now%=3;
	
		  for(var i=0;i<aBox.length;i++){
			  (function(index){
					setTimeout(function(){
						move(aBox[index],{opacity:0},{time:500,fn:function(){
							if(index==aBox.length-1){
								for(var i=0;i<aBox.length;i++){
									aBox[i].style.backgroundImage='url(images/img1/'+now+'.png)';
									aBox[i].style.opacity=1;
									aBox[i].style.filter='alpha(opacity:'+100%+')';
							    }
								oDiv.style.backgroundImage='url(images/img1/'+(now+1)%3+'.png)';
								ready=true;
							}
							
						}});
						
					},(aBox[index].r+aBox[index].c)*100);
				})(i);
		  }
			    
				  
		   
	};
	
	
	oBtn2.onclick=function(){
		//alert(2+":"+now)
		if(!ready) return;
		
		ready=false;
		
		var i=0;
		
		now++;
		now%=3;
		
		var timer2=setInterval(function(){
			    (function(index){
					
					 move(oDiv.children[i],{opacity:0},{time:500,fn:function(){
						if(index==oDiv.children.length-1){
							
							for(var i=0;i<oDiv.children.length;i++){
						   
							   oDiv.children[i].style.backgroundImage='url(images/img1/'+now+'.png)';
							   oDiv.children[i].style.opacity=1;
							   oDiv.children[i].style.filter='alpha(opacity:'+100%+')';
								
							} 
							oDiv.style.backgroundImage='url(images/img1/'+(now+1)%3+'.png)';
							ready=true;
						}
						
					 }});
				})(i);
				  
		   i++;
		   if(i==oDiv.children.length) clearInterval(timer2);
		},100);
	};
	
	oBtn3.onclick=function(){
		//alert(3+":"+now)
		if(!ready) return;
		
		ready=false;
		
		var i=0;
		
		now++;
		now%=3;
	var aBox=oDiv.children;	
	//alert(aBox.length)
		  for(var i=0;i<aBox.length;i++){
			  (function(index){
					setTimeout(function(){
						
						move(aBox[index],{opacity:0},{time:500});
						
					},Math.random()*500);
				})(i);
		  }
		
		setTimeout(function(){
			
				for(var i=0;i<aBox.length;i++){
					aBox[i].style.backgroundImage='url(images/img1/'+now+'.png)';
					aBox[i].style.opacity=1;
					aBox[i].style.filter='alpha(opacity:'+100%+')';
				}
				oDiv.style.backgroundImage='url(images/img1/'+(now+1)%3+'.png)';
				ready=true;
			
		
		
		},500+500+200);	    
				  
		   
	};
	
};
</script>


</head>

<body>
<input type="button" id="btn1" value="斜向" />
<input type="button" id="btn2" value="淡入淡出" />
<input type="button" id="btn3" value="随机" />
<div id="div1">
</div>
</body>
</html>
